import{_ as ze}from"./whisper-lStvj1H6.js";import{_ as Fe,a as Me}from"./post-item.vue_vue_type_style_index_0_lang-CUU82XTr.js";import{_ as xe}from"./post-skeleton-CLLZHz5p.js";import{_ as Se}from"./main-nav.vue_vue_type_style_index_0_lang-D5O26jqs.js";import{d as $e,r,c as Ce,b as Le,C as Be,f as i,q as u,t as h,Y as f,bq as o,w as _,h as ue,k as m,z as P,G as Q,A as ie,l as Ne,F as b,x as I,j as a}from"./@vue-CubVVfkF.js";import{u as Ue}from"./vuex-CXREYFZm.js";import{b as De,u as He}from"./vue-router-CQXvDuJO.js";import{e as L,L as Ve,u as je,f as Re,_ as Ge}from"./index-BQY0gBTt.js";import{p as W}from"./count-BK58UQ2M.js";import{Y as Qe}from"./v3-infinite-loading-DH9ovp49.js";import{a as We,q as Ye}from"./@vicons-CuMc_a8r.js";import{F as Ee,i as re,G as Je,a as Ke,m as Xe,O as Ze,B as et,Q as tt,g as at,f as st,J as lt,j as ot,H as nt}from"./naive-ui-Ck8OEwu2.js";import"./content-Ds9jA0WI.js";import"./paopao-video-player-DTaSDO5C.js";import"./copy-to-clipboard-DgsYVcxl.js";import"./toggle-selection-DGa8lynz.js";import"./vooks-hwk9FHDf.js";import"./evtd-CI_DDEu_.js";import"./axios-NIGUFBhG.js";import"./moment-CvIcpsue.js";/* empty css               */import"./seemly-s2h2JshW.js";import"./vueuc-Dmj3j_oC.js";import"./@css-render-D_aM2a22.js";import"./vdirs-DRH9Xvnd.js";import"./@juggle-BAaFDRb-.js";import"./css-render-DYRmsh0A.js";import"./@emotion-WldOFDRm.js";import"./lodash-es-CO3YFt-b.js";import"./treemate-HRdUPn5m.js";import"./async-validator-CFA_igpM.js";import"./date-fns-Db9XENWt.js";const ut={class:"profile-baseinfo"},it={class:"avatar"},rt={class:"base-info"},ct={class:"username"},_t={class:"userinfo"},vt={class:"info-item"},dt={class:"info-item"},mt={class:"userinfo"},ft={class:"info-item"},pt={class:"info-item"},ht={class:"info-item"},gt={class:"user-opts"},wt={key:0,class:"skeleton-wrap"},kt={key:1},yt={key:0,class:"empty-wrap"},bt={key:1},It={key:0},Ot={key:1},Pt={key:2},Tt={key:3},At={key:4},qt={key:2},zt={key:0},Ft={key:1},Mt={key:2},xt={key:3},St={key:4},$t={class:"load-more-wrap"},Ct={class:"load-more-spinner"},Lt=$e({__name:"Profile",setup(Bt){const n=Ue(),T=De(),ce=He(),_e=Ee(),d=r(!1),O=r(!1),l=r([]),A=r([]),q=r([]),z=r([]),F=r([]),M=r([]),p=r("post"),Y=r(+T.query.p||1),E=r(1),J=r(1),K=r(1),X=r(1),s=r(+T.query.p||1),g=r(20),v=r(0),Z=r(0),ee=r(0),te=r(0),ae=r(0),se=r(0),N=r(!1),le=r({id:0,avatar:"",username:"",nickname:"",is_admin:!1,is_friend:!0,is_following:!1,created_on:0,follows:0,followings:0,status:1}),ve=e=>()=>ue(re,null,{default:()=>ue(e)}),de=Ce(()=>[{label:"设置",key:"setting",icon:ve(We)}]),me=e=>{switch(e){case"setting":ce.push({name:"setting",query:{t:new Date().getTime()}});break}},w=e=>{le.value=e,N.value=!0},fe=()=>{N.value=!1},k=e=>{_e.success({title:"提示",content:"确定"+(e.user.is_following?"取消关注 @":"关注 @")+e.user.username+" 吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{e.user.is_following?je({user_id:e.user.id}).then(c=>{window.$message.success("操作成功"),oe(e.user_id,!1)}).catch(c=>{}):Re({user_id:e.user.id}).then(c=>{window.$message.success("关注成功"),oe(e.user_id,!0)}).catch(c=>{})}})};function oe(e,c){x(A.value,e,c),x(q.value,e,c),x(z.value,e,c),x(F.value,e,c),x(M.value,e,c)}function x(e,c,G){if(e&&e.length>0)for(let B in e)e[B].user_id==c&&(e[B].user.is_following=G)}const U=()=>{switch(p.value){case"post":D();break;case"comment":H();break;case"highlight":V();break;case"media":j();break;case"star":R();break}},D=()=>{d.value=!0,L({username:n.state.userInfo.username,style:"post",page:s.value,page_size:g.value}).then(e=>{d.value=!1,e.list.length===0&&(O.value=!0),s.value>1?l.value=l.value.concat(e.list):(l.value=e.list||[],window.scrollTo(0,0)),v.value=Math.ceil(e.pager.total_rows/g.value),A.value=l.value,Z.value=v.value}).catch(e=>{l.value=[],s.value>1&&s.value--,d.value=!1})},H=()=>{d.value=!0,L({username:n.state.userInfo.username,style:"comment",page:s.value,page_size:g.value}).then(e=>{d.value=!1,e.list.length===0&&(O.value=!0),s.value>1?l.value=l.value.concat(e.list):(l.value=e.list||[],window.scrollTo(0,0)),v.value=Math.ceil(e.pager.total_rows/g.value),q.value=l.value,ee.value=v.value}).catch(e=>{l.value=[],s.value>1&&s.value--,d.value=!1})},V=()=>{d.value=!0,L({username:n.state.userInfo.username,style:"highlight",page:s.value,page_size:g.value}).then(e=>{d.value=!1,e.list.length===0&&(O.value=!0),s.value>1?l.value=l.value.concat(e.list):(l.value=e.list||[],window.scrollTo(0,0)),v.value=Math.ceil(e.pager.total_rows/g.value),z.value=l.value,te.value=v.value}).catch(e=>{l.value=[],s.value>1&&s.value--,d.value=!1})},j=()=>{d.value=!0,L({username:n.state.userInfo.username,style:"media",page:s.value,page_size:g.value}).then(e=>{d.value=!1,e.list.length===0&&(O.value=!0),s.value>1?l.value=l.value.concat(e.list):(l.value=e.list||[],window.scrollTo(0,0)),v.value=Math.ceil(e.pager.total_rows/g.value),F.value=l.value,ae.value=v.value}).catch(e=>{l.value=[],s.value>1&&s.value--,d.value=!1})},R=()=>{d.value=!0,L({username:n.state.userInfo.username,style:"star",page:s.value,page_size:g.value}).then(e=>{d.value=!1,e.list.length===0&&(O.value=!0),s.value>1?l.value=l.value.concat(e.list):(l.value=e.list||[],window.scrollTo(0,0)),v.value=Math.ceil(e.pager.total_rows/g.value),M.value=l.value,se.value=v.value}).catch(e=>{l.value=[],s.value>1&&s.value--,d.value=!1})},pe=e=>{switch(p.value=e,p.value){case"post":l.value=A.value,s.value=Y.value,v.value=Z.value,D();break;case"comment":l.value=q.value,s.value=E.value,v.value=ee.value,H();break;case"highlight":l.value=z.value,s.value=J.value,v.value=te.value,V();break;case"media":l.value=F.value,s.value=K.value,v.value=ae.value,j();break;case"star":l.value=M.value,s.value=X.value,v.value=se.value,R();break}},he=()=>{switch(p.value){case"post":Y.value=s.value,D();break;case"comment":E.value=s.value,H();break;case"highlight":J.value=s.value,V();break;case"media":K.value=s.value,j();break;case"star":X.value=s.value,R();break}},ge=()=>{s.value<v.value||v.value==0?(O.value=!1,s.value++,he()):O.value=!0};return Le(()=>{U()}),Be(()=>({path:T.path,query:T.query,refresh:n.state.refresh}),(e,c)=>{if(e.refresh!==c.refresh){s.value=+T.query.p||1,setTimeout(()=>{U()},0);return}c.path!=="/post"&&e.path==="/profile"&&(s.value=+T.query.p||1,setTimeout(()=>{U()},0))}),(e,c)=>{const G=Se,B=Xe,we=Ze,ne=Ne("router-link"),ke=et,ye=tt,S=at,be=st,Ie=xe,Oe=lt,$=Fe,y=nt,C=Me,Pe=ze,Te=Je,Ae=ot,qe=Ke;return a(),i("div",null,[u(G,{title:"主页"}),o(n).state.userInfo.id>0?(a(),h(Te,{key:0,class:"main-content-wrap profile-wrap",bordered:""},{default:_(()=>[m("div",ut,[m("div",it,[u(B,{size:72,src:o(n).state.userInfo.avatar},null,8,["src"])]),m("div",rt,[m("div",ct,[m("strong",null,P(o(n).state.userInfo.nickname),1),m("span",null," @"+P(o(n).state.userInfo.username),1),o(n).state.userInfo.is_admin?(a(),h(we,{key:0,class:"top-tag",type:"error",size:"small",round:""},{default:_(()=>[...c[3]||(c[3]=[Q(" 管理员 ",-1)])]),_:1})):f("",!0)]),m("div",_t,[m("span",vt,"UID. "+P(o(n).state.userInfo.id),1),m("span",dt,P(o(Ve)(o(n).state.userInfo.created_on))+" 加入",1)]),m("div",mt,[m("span",ft,[u(ne,{onClick:c[0]||(c[0]=ie(()=>{},["stop"])),class:"following-link",to:{name:"following",query:{s:o(n).state.userInfo.username,n:o(n).state.userInfo.nickname,t:"follows"}}},{default:_(()=>[Q(" 关注  "+P(o(W)(o(n).state.userInfo.follows)),1)]),_:1},8,["to"])]),m("span",pt,[u(ne,{onClick:c[1]||(c[1]=ie(()=>{},["stop"])),class:"following-link",to:{name:"following",query:{s:o(n).state.userInfo.username,n:o(n).state.userInfo.nickname,t:"followings"}}},{default:_(()=>[Q(" 粉丝  "+P(o(W)(o(n).state.userInfo.followings)),1)]),_:1},8,["to"])]),m("span",ht," 泡泡  "+P(o(W)(o(n).state.userInfo.tweets_count)),1)])]),m("div",gt,[u(ye,{placement:"bottom-end",trigger:"click",size:"small",options:de.value,onSelect:me},{default:_(()=>[u(ke,{quaternary:"",circle:""},{icon:_(()=>[u(o(re),null,{default:_(()=>[u(o(Ye))]),_:1})]),_:1})]),_:1},8,["options"])])]),u(be,{class:"profile-tabs-wrap",type:"line",animated:"","onUpdate:value":pe},{default:_(()=>[u(S,{name:"post",tab:"泡泡"}),u(S,{name:"comment",tab:"评论"}),u(S,{name:"highlight",tab:"亮点"}),u(S,{name:"media",tab:"图文"}),u(S,{name:"star",tab:"喜欢"})]),_:1}),d.value&&l.value.length===0?(a(),i("div",wt,[u(Ie,{num:g.value},null,8,["num"])])):(a(),i("div",kt,[l.value.length===0?(a(),i("div",yt,[u(Oe,{size:"large",description:"暂无数据"})])):f("",!0),o(n).state.desktopModelShow?(a(),i("div",bt,[p.value==="post"?(a(),i("div",It,[(a(!0),i(b,null,I(A.value,t=>(a(),h(y,{key:t.id},{default:_(()=>[u($,{post:t,isOwner:o(n).state.userInfo.id==t.user_id,addFollowAction:!0,onSendWhisper:w,onHandleFollowAction:k},null,8,["post","isOwner"])]),_:2},1024))),128))])):f("",!0),p.value==="comment"?(a(),i("div",Ot,[(a(!0),i(b,null,I(q.value,t=>(a(),h(y,{key:t.id},{default:_(()=>[u($,{post:t,isOwner:o(n).state.userInfo.id==t.user_id,addFollowAction:!0,onSendWhisper:w,onHandleFollowAction:k},null,8,["post","isOwner"])]),_:2},1024))),128))])):f("",!0),p.value==="highlight"?(a(),i("div",Pt,[(a(!0),i(b,null,I(z.value,t=>(a(),h(y,{key:t.id},{default:_(()=>[u($,{post:t,isOwner:o(n).state.userInfo.id==t.user_id,addFollowAction:!0,onSendWhisper:w,onHandleFollowAction:k},null,8,["post","isOwner"])]),_:2},1024))),128))])):f("",!0),p.value==="media"?(a(),i("div",Tt,[(a(!0),i(b,null,I(F.value,t=>(a(),h(y,{key:t.id},{default:_(()=>[u($,{post:t,isOwner:o(n).state.userInfo.id==t.user_id,addFollowAction:!0,onSendWhisper:w,onHandleFollowAction:k},null,8,["post","isOwner"])]),_:2},1024))),128))])):f("",!0),p.value==="star"?(a(),i("div",At,[(a(!0),i(b,null,I(M.value,t=>(a(),h(y,{key:t.id},{default:_(()=>[u($,{post:t,isOwner:o(n).state.userInfo.id==t.user_id,addFollowAction:!0,onSendWhisper:w,onHandleFollowAction:k},null,8,["post","isOwner"])]),_:2},1024))),128))])):f("",!0)])):(a(),i("div",qt,[p.value==="post"?(a(),i("div",zt,[(a(!0),i(b,null,I(A.value,t=>(a(),h(y,{key:t.id},{default:_(()=>[u(C,{post:t,isOwner:o(n).state.userInfo.id==t.user_id,addFollowAction:!0,onSendWhisper:w,onHandleFollowAction:k},null,8,["post","isOwner"])]),_:2},1024))),128))])):f("",!0),p.value==="comment"?(a(),i("div",Ft,[(a(!0),i(b,null,I(q.value,t=>(a(),h(y,{key:t.id},{default:_(()=>[u(C,{post:t,isOwner:o(n).state.userInfo.id==t.user_id,addFollowAction:!0,onSendWhisper:w,onHandleFollowAction:k},null,8,["post","isOwner"])]),_:2},1024))),128))])):f("",!0),p.value==="highlight"?(a(),i("div",Mt,[(a(!0),i(b,null,I(z.value,t=>(a(),h(y,{key:t.id},{default:_(()=>[u(C,{post:t,isOwner:o(n).state.userInfo.id==t.user_id,addFollowAction:!0,onSendWhisper:w,onHandleFollowAction:k},null,8,["post","isOwner"])]),_:2},1024))),128))])):f("",!0),p.value==="media"?(a(),i("div",xt,[(a(!0),i(b,null,I(F.value,t=>(a(),h(y,{key:t.id},{default:_(()=>[u(C,{post:t,isOwner:o(n).state.userInfo.id==t.user_id,addFollowAction:!0,onSendWhisper:w,onHandleFollowAction:k},null,8,["post","isOwner"])]),_:2},1024))),128))])):f("",!0),p.value==="star"?(a(),i("div",St,[(a(!0),i(b,null,I(M.value,t=>(a(),h(y,{key:t.id},{default:_(()=>[u(C,{post:t,isOwner:o(n).state.userInfo.id==t.user_id,addFollowAction:!0,onSendWhisper:w,onHandleFollowAction:k},null,8,["post","isOwner"])]),_:2},1024))),128))])):f("",!0)]))])),u(Pe,{show:N.value,user:le.value,onSuccess:fe},null,8,["show","user"])]),_:1})):f("",!0),v.value>0?(a(),h(qe,{key:1,justify:"center"},{default:_(()=>[u(o(Qe),{class:"load-more",slots:{complete:"没有更多泡泡了",error:"加载出错"},onInfinite:c[2]||(c[2]=t=>ge())},{spinner:_(()=>[m("div",$t,[O.value?f("",!0):(a(),h(Ae,{key:0,size:14})),m("span",Ct,P(O.value?"没有更多泡泡了":"加载更多"),1)])]),_:1})]),_:1})):f("",!0)])}}}),pa=Ge(Lt,[["__scopeId","data-v-8e1957b9"]]);export{pa as default};
